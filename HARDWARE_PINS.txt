JARVIS HARDWARE PIN & CONNECTION GUIDE (BCM numbering unless noted)
===============================================================

IMPORTANT: Always use a COMMON GROUND between all modules (sensors, servo power, Pi).
Voltage levels: Raspberry Pi GPIO = 3.3V logic. Only supply 5V to modules that require it
and ensure any 5V signal returning to the Pi is level-shifted or divided (e.g., HC-SR04 ECHO).

LEGEND:
  BCM  = Broadcom GPIO number (used in code)
  Phys = Physical pin number on Raspberry Pi 40-pin header

SERVO CLUSTER (pigpio-controlled)
- Neck Servo (Head Rotation) : Signal BCM 18 (Phys 12)  | env SERVO_PIN_NECK
- Left Hand Servo            : Signal BCM 23 (Phys 16)  | env SERVO_PIN_ARM_L
- Right Hand Servo           : Signal BCM 24 (Phys 18)  | env SERVO_PIN_ARM_R
- COMMON POWER : External 5V supply (DO NOT use Pi 5V pins!)
- COMMON GND   : Any GND (Phys 6/9/14/20/25/30/34/39) + External supply GND
Notes:
  - Use a dedicated 5V supply (min 2A) for three servos; tie that supply's GND to Pi GND.
  - Default pulse window 500–2400µs; override with SERVO_MIN_PULSE_* / SERVO_MAX_PULSE_* env vars.
  - Neck servo uses angle offset (+90°) so 0° = forward facing.
  - pigpiod daemon **must** be running (`sudo systemctl enable --now pigpiod`).

---------------------------------------------------------------
ULTRASONIC SENSOR (HC-SR04)
---------------------------------------------------------------
TRIG    -> BCM 27 (Phys 13)  (ULTRASONIC_TRIGGER_PIN)
ECHO    -> BCM 22 (Phys 15)  (ULTRASONIC_ECHO_PIN)
VCC     -> 5V
GND     -> GND
Level Shift (Echo): Use voltage divider  (5V ECHO -> 1k -> junction -> 2k -> GND; junction to BCM22 ~3.3V)
Notes:
  - Pins changed from 23/24 to 27/22 to avoid conflict with hand servos.
  - Avoid cross-talk by adding small settle delay between angles during scans.
  - SCAN_* env vars control scanning behavior (see scanner module docstring).

---------------------------------------------------------------
PIR MOTION SENSOR
---------------------------------------------------------------
OUT     -> BCM 17 (Phys 11) (PIR_PIN)
VCC     -> 5V (some modules accept 3.3V; 5V recommended for range)
GND     -> GND
Notes:
  - Allow 30–60 seconds warm-up after power.
  - Motion callback posts to GUI as "System: Motion detected.".

---------------------------------------------------------------
DHT11 / DHT22 TEMPERATURE & HUMIDITY
---------------------------------------------------------------
DATA    -> BCM 4 (Phys 7) (DHT_PIN)
VCC     -> 3.3V (Phys 1)  (DHT11 tolerates 5V but 3.3V safest; DHT22 typically 3.3–5V)
GND     -> GND
Pull-Up -> 10K resistor from DATA to 3.3V (some breakout boards include this already)
Env Select: DHT_TYPE=11 or DHT_TYPE=22

---------------------------------------------------------------
MQ-3 ALCOHOL GAS SENSOR (with MCP3008 ADC)
---------------------------------------------------------------
Sensor analog out -> MCP3008 CH0 (or configured channel MQ3_ADC_CHANNEL)
MCP3008 VDD  -> 3.3V
MCP3008 VREF -> 3.3V (reference voltage sets ADC range)
MCP3008 AGND -> GND
MCP3008 DGND -> GND
MCP3008 CLK  -> BCM 11 (Phys 23)
MCP3008 DOUT -> BCM 9  (Phys 21) (MISO)
MCP3008 DIN  -> BCM 10 (Phys 19) (MOSI)
MCP3008 CS   -> BCM 8  (Phys 24) (CE0)
MQ-3 VCC     -> 5V (heating element requires warm-up) *Check module spec*
MQ-3 GND     -> GND
Notes:
  - Enable SPI: sudo raspi-config -> Interface Options -> SPI -> Enable
  - Warm-up: allow several minutes for stable baseline.
  - Code currently returns raw ADC value or simulated reading when spidev missing.

---------------------------------------------------------------
MOTOR DRIVER (L298N or similar dual H-bridge)
---------------------------------------------------------------
L_EN (ENA)  -> BCM 12 (Phys 32)  | env MOTOR_L_EN
L_IN1       -> BCM 5  (Phys 29)  | env MOTOR_L_IN1
L_IN2       -> BCM 6  (Phys 31)  | env MOTOR_L_IN2
R_EN (ENB)  -> BCM 13 (Phys 33)  | env MOTOR_R_EN
R_IN1       -> BCM 26 (Phys 37)  | env MOTOR_R_IN1
R_IN2       -> BCM 16 (Phys 36)  | env MOTOR_R_IN2
Motor VCC   -> 7–12V supply (NOT Pi 5V)
Motor GND   -> Shared with Pi ground
Logic VCC   -> 5V (Phys 2 or 4)
Notes:
  - Fit flyback diodes or use driver module with onboard diodes.
  - Ensure ENA/ENB jumpers removed if using PWM speed control.

---------------------------------------------------------------
LCD DISPLAY (16x2 with PCF8574 I²C backpack)
---------------------------------------------------------------
SDA -> BCM 2 (Phys 3)
SCL -> BCM 3 (Phys 5)
VCC -> 5V (Phys 2 or 4)
GND -> GND
Notes:
  - Enable I²C: sudo raspi-config -> Interface Options -> I2C -> Enable
  - Default address 0x27; override via DISPLAY_I2C_ADDRESS env if needed.

---------------------------------------------------------------
IR MODULES (LIRC managed)
---------------------------------------------------------------
IR Receiver : Configure overlay `dtoverlay=gpio-ir,gpio_pin=<PIN>` (default 18)
IR Emitter  : Configure overlay `dtoverlay=gpio-ir-tx,gpio_pin=<PIN>` (common 17)
VCC         : 3.3V (receiver), 5V via transistor driver (emitter LED)
GND         : Shared
Notes:
  - Jarvis tools rely on `irsend`/`irrecord`; wiring pin numbers must match `/boot/config.txt` overlays.
  - For high-power IR LED use NPN transistor + resistor; never drive LED directly from GPIO.

---------------------------------------------------------------
AUDIO I/O (Speech recognition & TTS)
---------------------------------------------------------------
Microphone : USB mic (recommended) or Pi audio hat
Speaker    : 3.5mm jack or USB DAC feeding powered speakers
Notes:
  - Vosk expects 16kHz mono input; adjust `.env` MICROPHONE_INDEX to choose device.
  - TTS uses system default output (ALSA/PulseAudio).

---------------------------------------------------------------
OPTIONAL / FUTURE EXPANSION
---------------------------------------------------------------
- Additional servos: Use separate pigpio channels; ensure adequate power.
- I2C devices: SDA -> BCM 2 (Phys 3), SCL -> BCM 3 (Phys 5) + 3.3V pull-ups (often on HAT/board).
- UART: TXD -> BCM 14 (Phys 8), RXD -> BCM 15 (Phys 10) (disable console login if repurposing).

---------------------------------------------------------------
ENVIRONMENT VARIABLES SUMMARY
---------------------------------------------------------------
SERVO_PIN                (default 12 or 19 depending on setup)
SERVO_MIN_PULSE          (e.g. 500)
SERVO_MAX_PULSE          (e.g. 2400)
ULTRASONIC_TRIGGER_PIN   (default 27)
ULTRASONIC_ECHO_PIN      (default 22)
PIR_PIN                  (default 17)
DHT_PIN                  (default 4)
DHT_TYPE                 (11 or 22)
MQ3_ADC_CHANNEL          (default 0)
SCAN_START_ANGLE         (default 30)
SCAN_END_ANGLE           (default 150)
SCAN_STEP                (default 15)
SCAN_SAMPLES_PER_ANGLE   (default 3)
SCAN_SETTLE              (default 0.18)
SCAN_RETRIES             (default 2)
SERVO_VERBOSE            (1=print angle->pulse)
FORCE_SIMULATION         (1=force sim mode regardless of hardware)

---------------------------------------------------------------
TROUBLESHOOTING QUICK NOTES
---------------------------------------------------------------
Servo not moving:
  - Check separate 5V supply & common ground
  - Verify correct BCM pin exported
  - Test with tools/servo_self_test.py

Ultrasonic timeouts:
  - Check echo voltage divider
  - Increase SCAN_SETTLE to 0.25
  - Ensure no object <2 cm (dead zone)

PIR no motion:
  - Wait full warm-up
  - Adjust sensitivity / retrigger jumpers (H/L) if present

DHT failures:
  - Confirm pull-up resistor
  - Use DHT_TYPE=22 if using DHT22
  - Give sensor 2–5 seconds between reads

MQ-3 unstable:
  - Warm-up 5–10 minutes
  - Shield from airflow
  - Calibrate baseline in clean air

---------------------------------------------------------------
REVISION LOG
---------------------------------------------------------------
2025-10-06 Initial version generated by automation.

End of file.
